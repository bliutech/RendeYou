<!--
  Temporary frontend to test backend endpoints.
-->

<!DOCTYPE html>
<html>

<head>

</head>

<body>
  <form id="register">
    <p>/register</p>
    <p><label>username: <input></label></p>
    <p><label>password: <input type="password"></label></p>
    <input type="submit">
  </form>

  <form id="get-user">
    <p>/user/[id]</p>
    <p><label>id: <input></label></p>
    <input type="submit">
  </form>

  <form id="search-users">
    <p>/user</p>
    <p><label>ids: <input id="search-ids"></label></p>
    <p><label>username: <input id="search-username"></label></p>
    <p><label>first: <input id="search-first"></label></p>
    <p><label>last: <input id="search-last"></label></p>
    <input type="submit">
  </form>

  <form id="login">
    <p>/login</p>
    <p><label>username: <input></label></p>
    <p><label>password: <input type="password"></label></p>
    <input type = "submit">
  </form>
  
  <form id="logout">
    <p>/logout</p>
    <input type = "submit">
  </form> 

  <script>
    function backend(endpoint) {
      return "http://localhost:8000" + endpoint;
    }

    function toQuery(obj) {
      return new URLSearchParams(obj).toString();
    }

    const registerForm = document.getElementById("register");
    registerForm.addEventListener("submit", function(e) {
      e.preventDefault();
      const data = {
        username: registerForm.querySelector("input").value,
        password: registerForm.querySelector("input[type=password]").value
      }
      fetch(backend("/register"), {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
      });
    });

    const getUserForm = document.getElementById("get-user");
    getUserForm.addEventListener("submit", function(e) {
      e.preventDefault();
      const id = getUserForm.querySelector("input").value;
      fetch(backend("/user/" + id));
    });

    const searchUsersForm = document.getElementById("search-users");
    searchUsersForm.addEventListener("submit", function (e) {
      e.preventDefault();
      const data = {
        ids: document.getElementById("search-ids").value,
        username: document.getElementById("search-username").value,
        first: document.getElementById("search-first").value,
        last: document.getElementById("search-last").value
      };
      fetch(backend("/user?" + toQuery(data)));
    });

    const getLoggedUser = document.getElementById("login");
    getLoggedUser.addEventListener("submit", function(e) {
      e.preventDefault();
      const data = {
        username: registerForm.querySelector("input").value,
        password: registerForm.querySelector("input[type=password]").value
      }
      fetch(backend("/login"), {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
      });
    });

    const Logout = document.getElementById("logout");
    Logout.addEventListener("submit", function(e) {
      e.preventDefault();
      fetch(backend("/logout"), {
        method: "POST"
      });
    });
  </script>
</body>

</html>
